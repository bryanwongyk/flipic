{"ast":null,"code":"import _regeneratorRuntime from\"/home/sam/Documents/flipic/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/sam/Documents/flipic/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/sam/Documents/flipic/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useEffect,useState}from'react';import{useAuth0}from'@auth0/auth0-react';var useUserMetadata=function useUserMetadata(setIsBusyGettingAccessToken){var _useAuth=useAuth0(),user=_useAuth.user,getAccessTokenSilently=_useAuth.getAccessTokenSilently;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),userMetadata=_useState2[0],setUserMetadata=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),accessToken=_useState4[0],setAccessToken=_useState4[1];useEffect(function(){var getUserMetadata=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var domain,_accessToken,userDetailsByIdUrl,metadataResponse,_yield$metadataRespon,user_metadata;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:domain='dev-bwkc1q2n.us.auth0.com';_context.prev=1;_context.next=4;return getAccessTokenSilently({audience:\"https://\".concat(domain,\"/api/v2/\"),scope:'read:current_user'});case 4:_accessToken=_context.sent;setAccessToken(_accessToken);userDetailsByIdUrl=\"https://\".concat(domain,\"/api/v2/users/\").concat(user.sub);_context.next=9;return fetch(userDetailsByIdUrl,{headers:{Authorization:\"Bearer \".concat(_accessToken)}});case 9:metadataResponse=_context.sent;_context.next=12;return metadataResponse.json();case 12:_yield$metadataRespon=_context.sent;user_metadata=_yield$metadataRespon.user_metadata;console.log('GETTING USER METADATA');setUserMetadata(user_metadata);setIsBusyGettingAccessToken(false);_context.next=22;break;case 19:_context.prev=19;_context.t0=_context[\"catch\"](1);console.log(_context.t0.message);case 22:case\"end\":return _context.stop();}}},_callee,null,[[1,19]]);}));return function getUserMetadata(){return _ref.apply(this,arguments);};}();getUserMetadata();},[]);return{userMetadata:userMetadata,accessToken:accessToken,user:user};};export default useUserMetadata;","map":{"version":3,"sources":["/home/sam/Documents/flipic/front-end/src/hooks/useUserMetadata.js"],"names":["useEffect","useState","useAuth0","useUserMetadata","setIsBusyGettingAccessToken","user","getAccessTokenSilently","userMetadata","setUserMetadata","accessToken","setAccessToken","getUserMetadata","domain","audience","scope","userDetailsByIdUrl","sub","fetch","headers","Authorization","metadataResponse","json","user_metadata","console","log","message"],"mappings":"8cAAA,OAASA,SAAT,CAAoBC,QAApB,KAAoC,OAApC,CACA,OAASC,QAAT,KAAyB,oBAAzB,CAEA,GAAMC,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAAAC,2BAA2B,CAAI,CACtD,aAAyCF,QAAQ,EAAjD,CAAQG,IAAR,UAAQA,IAAR,CAAcC,sBAAd,UAAcA,sBAAd,CACA,cAAwCL,QAAQ,CAAC,IAAD,CAAhD,wCAAOM,YAAP,eAAqBC,eAArB,eACA,eAAsCP,QAAQ,CAAC,IAAD,CAA9C,yCAAOQ,WAAP,eAAoBC,cAApB,eAEAV,SAAS,CAAC,UAAM,CACf,GAAMW,CAAAA,eAAe,0FAAG,mOACjBC,MADiB,CACR,2BADQ,uCAIIN,CAAAA,sBAAsB,CAAC,CAChDO,QAAQ,mBAAaD,MAAb,YADwC,CAEhDE,KAAK,CAAE,mBAFyC,CAAD,CAJ1B,QAIhBL,YAJgB,eAQtBC,cAAc,CAACD,YAAD,CAAd,CAEMM,kBAVgB,mBAUgBH,MAVhB,0BAUuCP,IAAI,CAACW,GAV5C,wBAYSC,CAAAA,KAAK,CAACF,kBAAD,CAAqB,CACxDG,OAAO,CAAE,CACRC,aAAa,kBAAYV,YAAZ,CADL,CAD+C,CAArB,CAZd,QAYhBW,gBAZgB,sCAkBUA,CAAAA,gBAAgB,CAACC,IAAjB,EAlBV,6CAkBdC,aAlBc,uBAkBdA,aAlBc,CAmBtBC,OAAO,CAACC,GAAR,CAAY,uBAAZ,EACAhB,eAAe,CAACc,aAAD,CAAf,CACAlB,2BAA2B,CAAC,KAAD,CAA3B,CArBsB,iFAuBtBmB,OAAO,CAACC,GAAR,CAAY,YAAEC,OAAd,EAvBsB,qEAAH,kBAAfd,CAAAA,eAAe,0CAArB,CA2BAA,eAAe,GACf,CA7BQ,CA6BN,EA7BM,CAAT,CA8BA,MAAO,CAAEJ,YAAY,CAAZA,YAAF,CAAgBE,WAAW,CAAXA,WAAhB,CAA6BJ,IAAI,CAAJA,IAA7B,CAAP,CACA,CApCD,CAsCA,cAAeF,CAAAA,eAAf","sourcesContent":["import { useEffect, useState } from 'react';\nimport { useAuth0 } from '@auth0/auth0-react';\n\nconst useUserMetadata = setIsBusyGettingAccessToken => {\n\tconst { user, getAccessTokenSilently } = useAuth0();\n\tconst [userMetadata, setUserMetadata] = useState(null);\n\tconst [accessToken, setAccessToken] = useState(null);\n\n\tuseEffect(() => {\n\t\tconst getUserMetadata = async () => {\n\t\t\tconst domain = 'dev-bwkc1q2n.us.auth0.com';\n\n\t\t\ttry {\n\t\t\t\tconst accessToken = await getAccessTokenSilently({\n\t\t\t\t\taudience: `https://${domain}/api/v2/`,\n\t\t\t\t\tscope: 'read:current_user',\n\t\t\t\t});\n\t\t\t\tsetAccessToken(accessToken);\n\n\t\t\t\tconst userDetailsByIdUrl = `https://${domain}/api/v2/users/${user.sub}`;\n\n\t\t\t\tconst metadataResponse = await fetch(userDetailsByIdUrl, {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\tAuthorization: `Bearer ${accessToken}`,\n\t\t\t\t\t},\n\t\t\t\t});\n\n\t\t\t\tconst { user_metadata } = await metadataResponse.json();\n\t\t\t\tconsole.log('GETTING USER METADATA');\n\t\t\t\tsetUserMetadata(user_metadata);\n\t\t\t\tsetIsBusyGettingAccessToken(false);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log(e.message);\n\t\t\t}\n\t\t};\n\n\t\tgetUserMetadata();\n\t}, []);\n\treturn { userMetadata, accessToken, user };\n};\n\nexport default useUserMetadata;\n"]},"metadata":{},"sourceType":"module"}